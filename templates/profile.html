{% extends 'base.html' %} 

{% block title %}Profile{% endblock %} 

{% block content %}

<h1>{{user.fname}}'s Profile</h1>

<h2>Your Trips:</h2>
{% if vacations %}
<table id="user-vacations-profile-table">
    <tr>
        <th>Departure Date:</th>
        <th>Arrival Date:</th>
        <th>State:</th>
        <th>City:</th>
        <th>See Events and Tips:</th>
        <th>Edit This Vacation:</th>
        <th>Delete This Vacation:</th>
    </tr>
    
    {% for vacation in vacations %}
    <tr>
        <td>{{ vacation.vacation_label.departure_date.month }} / {{ vacation.vacation_label.departure_date.day }}
            / {{vacation.vacation_label.departure_date.year}}</td>
        <td>{{ vacation.vacation_label.arrival_date.month }} / {{ vacation.vacation_label.arrival_date.day }} /
            {{vacation.vacation_label.arrival_date.year}}</td>
        <td>{{ vacation.vacation_label.state.state_name }}</td>
        <td>{{ vacation.vacation_label.state.city.city_name }}</td>
        <td><button class="btn btn-outline-primary btn-sm" id="profile-see-desintation-btn">
            <a class="desination-links" href="/destination_details?state={{vacation.vacation_label.state.state_name}}&city={{ vacation.vacation_label.state.city.city_name }}&departure-date={{ vacation.vacation_label.departure_date }}&arrival-date={{ vacation.vacation_label.arrival_date }}">
                Events and Tips</a></button></td>
        <td><button class="btn btn-outline-primary btn-sm" id="profile-edit-vacation-btn">
            Edit Vacation
        </button></td>
        <td><button class="btn btn-outline-danger btn-sm" id="profile-delete-vacation-btn" 
            name="{{vacation.vacation_id}}">Delete</button></td>
    </tr>
    {% endfor %}
</table>

{% else %}
<h3>No trips yet, add one <a href="/create_vacation">here</a></h3>
{% endif %}
<div id="user-vacation-after-delete-div"></div>

{% if event_names %}
<h2>Events Scheduled During Your Vacation</h2>

<div id="destination-details-event-container-div">
    <table id="destination-details-event-table">
        
        {% for i in range(5) %}
        <tr class="destination-details-event-table-rows">

            <td id="destination-details-event-image">
                <img class="destination-details-image" src="{{ img_urls[i] }}">
            </td>

            <td id="destination_details-event-date-time">
                {{ start_dates[i] }} 

                {% if start_times[i] %}
                    <p>{{ start_times[i] }}</p>
                    </td>
                {% else %}
                    </td>
                {% endif %}

            <td id="destination-details-event-name">
                {{ event_names[i] }}
                {% if venues[i] %}
                    <p>At the {{ venues[i] }}</p>
                    <p>
                        <button class="btn btn-primary" type="button" id="destination-details-event-link-to-ticketmaster">
                        <a href="{{ event_urls[i] }}">Get Tickets Here</a>
                    </button>
                </p>
                {% endif %}
            </td>

            <p></p>
        {% endfor %}
        </tr>
    </table>
</div>
{% endif %}

<p></p>
<div id="user-travel-tips">
    {% if tip_tags %}
    <h2>Your Travel Tips:</h2>
    <table>
        <tr>
            <th>Tag:</th>
            <th>State:</th>
            <th>City:</th>
            <th>Tip:</th>
        </tr>

        {% for tip_tag in tip_tags %}
        <tr>
            <td>{{ tip_tag.tag.tag_name }}</td>
            <td>{{ tip_tag.tag.tag_state }}</td>
            <td>{{ tip_tag.tag.tag_city }}</td>
            <td>{{ tip_tag.tip.tip_text }}</td>
        </tr>
        {% endfor %}
    {% else %}
    <h2>Your Travel Tips:</h2>
    <h4>None added yet, add one <a href="/create_tip">here</a></h4>
    {% endif %}
</div>

<h2>{{ user.fname }} Contact Information</h2>

<p id="edit-email-paragraph"><strong>Email: {{ user.email }}</strong><button class="btn btn-light" id="edit-email-button">Update Email Address</button></p>

<p id="edit-username-paragraph"><strong>Username: {{ user.username }}</strong><button class="btn btn-light" id="edit-username-button">Change Username</button></p>

<p id="edit-password-paragraph"><strong>Password: {% for char in user.password %}*{% endfor %}
    </strong><button class="btn btn-light" id="edit-password-button">Change Password</button></p>

<script src="http://code.jquery.com/jquery.js"></script>
<script src="static/js/edit_profile.js"></script>

{% endblock %}